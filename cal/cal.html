<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
        integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap" rel="stylesheet">

    <title>行事曆｜My Cal</title>
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            ;
        }
    </style>
</head>

<body>

    <nav class="navbar navbar-light bg-dark text-center justify-content-center mb-4 ">
        <a class="navbar-brand" href="#">
            <img src="/ice-cream.png" width="40" height="40" alt="" loading="lazy">
        </a>
    </nav>

    <div class="container bg-dark">
        <div class="row justify-content-center ">

            <div class="col-md-5 bg-light mt-5 col">
                <div class="col mt-2">
                    <h1>。待辦事項</h1>
                </div>

                <div class="col text-center" id="cardskc">

                    <div class="col mt-5">
                        <h4>未有行程唷＞＜"</h4>
                    </div>
                    <div class="col mt-5">
                        <img src="/ice-cream.png" alt="">
                    </div>
                    <div class="col mt-5">
                        <button type="button" class="btn btn-dark" data-toggle="modal" data-target="#staticBackdrop">
                            新增代辦事項
                        </button>
                    </div>
                    <div class="col mt-5">
                        <img src="/market.png" width="200" height="200" alt="">
                    </div>

                </div>
            </div>
            <div class="col-md-6 bg-light mt-5 col">
                <div class="col mt-2">
                    <div class="row justify-content-center text-center align-items-center">
                        <div class="col-md-4 col">
                            <button class="btn" onclick="prev()">◄ PREV</button>
                        </div>
                        <div class="col-md-4 col" id="ytitle"></div>
                        <div class="col-md-4 col">
                            <button class="btn" onclick="next()">NEXT ►</button>
                        </div>
                    </div>
                </div>
                <div class="col-md-12">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Sun</th>
                                <th>Mon</th>
                                <th>Tue</th>
                                <th>Wen</th>
                                <th>Thu</th>
                                <th>Fri</th>
                                <th>Sat</th>
                            </tr>
                        </thead>
                        <tbody id="days">

                        </tbody>
                    </table>
                </div>


            </div>

        </div>
    </div>

    <!-- ---------------新增待辦事項------------------- -->

    <!-- Modal -->
    <div class="modal fade" id="staticBackdrop" data-backdrop="static" data-keyboard="false" tabindex="-1"
        aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">

                    <h5 class="modal-title" id="staticBackdropLabel">新增待辦事項</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <label id="datenow">日期：</label>
                    <input type="text" class="form-control" placeholder="20200805" id="adddate">

                    <label for="addtitle">標題：</label>
                    <br>
                    <input type="text" class="form-control" id="addtitle" placeholder="要去哪裡玩呢？">
                    <label for="addnote">內容備註：</label>

                    <div class="input-group">

                        <textarea id="addnote" class="form-control" aria-label="With textarea"></textarea>
                    </div>
                </div>
                <div class="modal-footer">

                    <button type="button" class="btn" onclick="addskc()">確定新增</button>
                    <button type="button" class="btn" data-dismiss="modal">取消</button>
                </div>
            </div>
        </div>
    </div>


    <!-- -----------------------原始碼---------------------- -->
    <script>
        var date = new Date();
        var my_year = date.getFullYear();
        var my_month = date.getMonth();
        var day = date.getDate();
        var holder = document.getElementById('days');
        var yeartitle = document.getElementById('ytitle');
        datenow.innerHTML = '日期:' + my_year + '年' + (my_month + 1) + '月' + day + '日';

        function dateStart(year, month) {
            let start = new Date(year, month, 1);
            return start.getDay();
        }

        function daysOfMonth(year, month) {
            let days = new Date(year, (month + 1), 0).getDate();
            return days;
        }

        function dates() {
            var blank = '<tr>';
            var totalDay = daysOfMonth(my_year, my_month);
            var firstDay = dateStart(my_year, my_month);

            var j = 0;

            for (var i = 0; i < firstDay; i++) {
                blank += '<td></td>';
                j++;
            }
            for (var i = 1; i <= totalDay; i++) {

                blank += `<td><button type="button" class="btn" onclick="skcCard()">
                ${i}
                </button></td>`;
                j++;

                if (j % 7 == 0) {
                    blank += '</tr><tr>'
                };

            }
            blank += '</tr>';

            holder.innerHTML = blank;
            yeartitle.innerHTML = `<h4>${my_year}</h4>` + `<h2>${my_month+1}</h2>`;
        }
        dates();

        function prev() {
            if (my_month <= 0) {
                my_year = my_year - 1;
                my_month = 11;
            } else {
                my_month = my_month - 1;
            }
            dates();
        }

        function next() {
            if (my_month >= 11) {
                my_year = my_year + 1;
                my_month = 0;
            } else {
                my_month = my_month + 1;
            }
            dates();
        }

        function addskc() {
            var adddate = document.getElementById('adddate').value;
            var titledata = document.getElementById('addtitle').value;
            var notedata = document.getElementById('addnote').value;
            let skc = {
                dt: adddate,
                Title: titledata,
                Note: notedata,
                Location: '台北市淡水區山上一處',
            }

            localStorage.setItem(adddate, JSON.stringify(skc))
        }

        function skcCard() {

            /* let clickno = document. */
            let skc = JSON.parse(localStorage.getItem('20200825'));

            if (skc == null) {
                document.getElementById('cardskc').innerHTML = `  
                <div class="col mt-5">
                        <h4>未有行程唷＞＜"</h4>
                    </div>
                    <div class="col mt-5">
                        <img src="/ice-cream.png" alt="">
                    </div>
                    <div class="col mt-5">
                        <button type="button" class="btn btn-dark" data-toggle="modal" data-target="#staticBackdrop">
                            新增代辦事項
                        </button>
                    </div>
                    <div class="col mt-5">
                        <img src="/market.png" width="200" height="200" alt="">
                    </div>`;
            } else {

                document.getElementById('cardskc').innerHTML = `   
                <div class="card mt-5">
                        <div class="card-body">
                            <img src="/ice-cream-truck.png" width="40" height="40">
                            <h5 class="card-title mt-5" id="card-title"></h5>
                            <p class="card-text" id="card-text"></p>
                            <a href="#" class="btn btn-light">提醒我</a>
                            <a href="#" class="btn btn-light">導航去</a>
                        </div>
                    </div>
                    <div class="col mt-5">
                        <button type="button" class="btn btn-dark" data-toggle="modal" data-target="#staticBackdrop">
                            新增代辦事項
                        </button>
                    </div>`;
                document.getElementById('card-title').innerText = skc.Title;
                document.getElementById('card-text').innerText = skc.Note;
            }



        }
    </script>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous">
    </script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
        integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous">
    </script>
</body>

</html>